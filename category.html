<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Filter</title>
    <link rel="stylesheet" href="/Alibaba-Aces_110/category.css">
</head>
<body>
    <div class="container">
        <h1>Product Filter</h1>
        <div class="filter-options">
            <label for="category">Category:</label>
            <div id="category-grid" class="grid">
                <!-- Category options will be dynamically added here -->
            </div>
            <div id="subcategory-container" class="hidden">
                <label for="subcategory">Subcategory:</label>
                <div id="subcategory-grid" class="grid">
                    <!-- Subcategory options will be dynamically added here -->
                </div>
            </div>
        </div>
        <div id="product-list" class="product-list"></div>
    </div>
    <script>
        let products = [];

document.addEventListener("DOMContentLoaded", () => {
    fetchProducts();
});

function fetchProducts() {
    fetch("https://mock-server-api-wh0v.onrender.com/products")
        .then(response => response.json())
        .then(data => {
            products = data;
            populateCategories();
        })
        .catch(error => console.error('Error fetching products:', error));
}

function populateCategories() {
    const categories = new Set();
    products.forEach(product => {
        categories.add(product.category);
    });

    const categoryGrid = document.getElementById("category-grid");
    categoryGrid.innerHTML = '';
    categories.forEach(category => {
        const button = document.createElement("button");
        button.textContent = category;
        button.onclick = () => {
            document.querySelectorAll('#category-grid button').forEach(btn => btn.classList.remove('selected'));
            button.classList.add('selected');
            populateSubcategories(category);
        };
        categoryGrid.appendChild(button);
    });
}

function populateSubcategories(selectedCategory) {
    const subcategories = new Set();
    products.forEach(product => {
        if (product.category === selectedCategory) {
            subcategories.add(product.subcategory);
        }
    });

    const subcategoryContainer = document.getElementById("subcategory-container");
    subcategoryContainer.classList.remove("hidden");

    const subcategoryGrid = document.getElementById("subcategory-grid");
    subcategoryGrid.innerHTML = '<button class="selected">All</button>';
    subcategories.forEach(subcategory => {
        const button = document.createElement("button");
        button.textContent = subcategory;
        button.onclick = () => {
            document.querySelectorAll('#subcategory-grid button').forEach(btn => btn.classList.remove('selected'));
            button.classList.add('selected');
            filterProducts(selectedCategory, subcategory);
        };
        subcategoryGrid.appendChild(button);
    });

    filterProducts(selectedCategory, 'All');
}

function filterProducts(selectedCategory, selectedSubcategory) {
    const productList = document.getElementById("product-list");
    productList.innerHTML = '';

    products.forEach(product => {
        if (
            product.category === selectedCategory &&
            (selectedSubcategory === 'All' || product.subcategory === selectedSubcategory)
        ) {
            const productElement = document.createElement("div");
            productElement.className = "product";
            productElement.innerHTML = `
                <img src="${product.url}" alt="${product.productname}">
                <h2>${product.productname}</h2>
                <p class="price">Price: â‚¹${product.costprice}</p>
            `;
            productList.appendChild(productElement);
        }
    });
}

    </script>
</body>
</html>
